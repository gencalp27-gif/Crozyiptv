<!-- basit form -->
<input id="xtServer" placeholder="http://provider:8080">
<input id="xtUser" placeholder="username">
<input id="xtPass" placeholder="password">
<button id="loginBtn">Giriş Yap (Xtream)</button>

<script>
document.getElementById('loginBtn').addEventListener('click', async () => {
  const server = document.getElementById('xtServer').value.trim();
  const username = document.getElementById('xtUser').value.trim();
  const password = document.getElementById('xtPass').value.trim();
  if (!server || !username || !password) return alert('Eksik bilgi');

  try {
    // Örnek: proxy sunucunun adresi
    const proxyBase = 'https://senin-proxy.example.com';

    // 1) M3U almak istersen:
    const r = await fetch(proxyBase + '/api/xtream/fetch-m3u', {
      method: 'POST',
      headers: { 'Content-Type':'application/json' },
      body: JSON.stringify({ server, username, password, type:'m3u_plus' })
    });
    if (!r.ok) throw new Error('M3U fetch failed: ' + r.status);
    const m3uText = await r.text();
    // parseM3U fonksiyonunu kullan (kendi playerında var). Ör: parseM3U(m3uText)
    console.log('M3U length', m3uText.length);

    // 2) veya JSON üzerinden (daha yapılandırılmış)
    const r2 = await fetch(proxyBase + '/api/xtream/player-api', {
      method:'POST', headers:{'Content-Type':'application/json'},
      body: JSON.stringify({ server, username, password, action:'get_live_categories' })
    });
    const categories = await r2.json();
    console.log(categories);

    // Sonrasında kanalları render et ve playChannel ile oynat.
  } catch (err) {
    console.error(err);
    alert('Hata: ' + err.message);
  }
});
</script>